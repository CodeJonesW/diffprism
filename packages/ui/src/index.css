@import "react-diff-view/style/index.css";

@tailwind base;
@tailwind components;
@tailwind utilities;

/* ─── Theme variables ─── */

:root {
  /* Layout */
  --color-background: #e5e9f2;
  --color-surface: #d8dde9;
  --color-border: #b3bbd0;
  --color-text-primary: #141828;
  --color-text-secondary: #434e65;
  --color-accent: #4f3fba;

  /* Diff */
  --color-diff-bg: #e5e9f2;
  --color-diff-text: #141828;
  --color-gutter-bg: #d8dde9;
  --color-gutter-text: #434e65;
  --color-gutter-border: #b3bbd0;

  /* Diff additions */
  --color-diff-insert-bg: rgba(30, 160, 120, 0.15);
  --color-diff-insert-gutter-bg: rgba(30, 160, 120, 0.22);
  --color-diff-insert-gutter-text: #14704f;

  /* Diff deletions */
  --color-diff-delete-bg: rgba(210, 75, 65, 0.15);
  --color-diff-delete-gutter-bg: rgba(210, 75, 65, 0.22);
  --color-diff-delete-gutter-text: #b02e26;

  /* Diff hunks */
  --color-hunk-bg: rgba(90, 72, 201, 0.10);
  --color-hunk-border: #b3bbd0;
  --color-hunk-gutter-bg: rgba(79, 63, 186, 0.15);
  --color-hunk-gutter-text: #4f3fba;
  --color-hunk-content-text: #434e65;

  /* Word-level diff */
  --color-diff-edit-insert: rgba(30, 160, 120, 0.42);
  --color-diff-edit-delete: rgba(210, 75, 65, 0.42);

  /* Split view divider */
  --color-split-divider: #b3bbd0;

  /* Widget */
  --color-widget-bg: #d8dde9;

  /* Inline comment button */
  --color-comment-btn-bg: #167a5c;
  --color-comment-indicator: #4f3fba;
  --color-annotation-indicator: #c07820;

  /* Scrollbar */
  --color-scrollbar-track: #e5e9f2;
  --color-scrollbar-thumb: #b3bbd0;
  --color-scrollbar-thumb-hover: #98a2b8;

  /* Syntax tokens */
  --color-token-comment: #6b7a8f;
  --color-token-punctuation: #1a1f2e;
  --color-token-property: #0b6e82;
  --color-token-string: #0e7a5c;
  --color-token-operator: #c93c33;
  --color-token-keyword: #6e45c9;
  --color-token-function: #2870c9;
  --color-token-variable: #b06e18;

  /* Semantic status colors */
  --color-success: #0e7a5c;
  --color-danger: #c93c33;
  --color-warning: #b06e18;
  --color-info: #2870c9;
  --color-neutral: #6b7a8f;
  --color-perf: #c07820;

  /* Semantic colors for Tailwind */
  --color-added: rgba(30, 160, 120, 0.40);
  --color-deleted: rgba(210, 75, 65, 0.40);
}

.dark {
  /* Layout */
  --color-background: #0b0f1a;
  --color-surface: #131829;
  --color-border: #252d3f;
  --color-text-primary: #dfe5f1;
  --color-text-secondary: #7585a3;
  --color-accent: #7c6bf0;

  /* Diff */
  --color-diff-bg: #0b0f1a;
  --color-diff-text: #dfe5f1;
  --color-gutter-bg: #111623;
  --color-gutter-text: #7585a3;
  --color-gutter-border: #252d3f;

  /* Diff additions */
  --color-diff-insert-bg: rgba(45, 185, 140, 0.12);
  --color-diff-insert-gutter-bg: rgba(45, 185, 140, 0.18);
  --color-diff-insert-gutter-text: #5ee0b2;

  /* Diff deletions */
  --color-diff-delete-bg: rgba(235, 100, 90, 0.12);
  --color-diff-delete-gutter-bg: rgba(235, 100, 90, 0.18);
  --color-diff-delete-gutter-text: #f07068;

  /* Diff hunks */
  --color-hunk-bg: rgba(124, 107, 240, 0.08);
  --color-hunk-border: #252d3f;
  --color-hunk-gutter-bg: rgba(124, 107, 240, 0.12);
  --color-hunk-gutter-text: #9688f0;
  --color-hunk-content-text: #7585a3;

  /* Word-level diff */
  --color-diff-edit-insert: rgba(45, 185, 140, 0.35);
  --color-diff-edit-delete: rgba(235, 100, 90, 0.35);

  /* Split view divider */
  --color-split-divider: #252d3f;

  /* Widget */
  --color-widget-bg: #131829;

  /* Inline comment button */
  --color-comment-btn-bg: #2db98c;
  --color-comment-indicator: #7c6bf0;
  --color-annotation-indicator: #e0a050;

  /* Scrollbar */
  --color-scrollbar-track: #0b0f1a;
  --color-scrollbar-thumb: #252d3f;
  --color-scrollbar-thumb-hover: #3a4560;

  /* Syntax tokens */
  --color-token-comment: #5f6f8a;
  --color-token-punctuation: #bec8db;
  --color-token-property: #56c8e0;
  --color-token-string: #42c9a2;
  --color-token-operator: #f07a6e;
  --color-token-keyword: #b08df0;
  --color-token-function: #6aabf7;
  --color-token-variable: #e0a050;

  /* Semantic status colors */
  --color-success: #42c9a2;
  --color-danger: #f07a6e;
  --color-warning: #e0a050;
  --color-info: #6aabf7;
  --color-neutral: #5f6f8a;
  --color-perf: #e89040;

  /* Semantic colors for Tailwind */
  --color-added: rgba(45, 185, 140, 0.40);
  --color-deleted: rgba(235, 100, 90, 0.40);
}

/* ─── Dark theme overrides for react-diff-view ─── */

.diff-unified,
.diff-split {
  background-color: var(--color-diff-bg);
  color: var(--color-diff-text);
  font-family: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas,
    "Liberation Mono", monospace;
  font-size: 13px;
  line-height: 20px;
}

.diff-unified .diff-gutter,
.diff-split .diff-gutter {
  background-color: var(--color-gutter-bg);
  color: var(--color-gutter-text);
  border-right: 1px solid var(--color-gutter-border);
  padding: 0 8px;
  min-width: 50px;
  text-align: right;
  user-select: none;
  cursor: default;
}

.diff-unified .diff-gutter-col,
.diff-split .diff-gutter-col {
  width: 60px;
  min-width: 60px;
}

.diff-unified .diff-code,
.diff-split .diff-code {
  padding: 0 12px;
  white-space: pre;
}

/* Addition lines */
.diff-unified .diff-code-insert,
.diff-split .diff-code-insert {
  background-color: var(--color-diff-insert-bg);
}

.diff-unified .diff-code-insert .diff-code-text,
.diff-split .diff-code-insert .diff-code-text {
  background-color: transparent;
}

.diff-unified .diff-gutter-insert,
.diff-split .diff-gutter-insert {
  background-color: var(--color-diff-insert-gutter-bg);
  color: var(--color-diff-insert-gutter-text);
}

/* Deletion lines */
.diff-unified .diff-code-delete,
.diff-split .diff-code-delete {
  background-color: var(--color-diff-delete-bg);
}

.diff-unified .diff-code-delete .diff-code-text,
.diff-split .diff-code-delete .diff-code-text {
  background-color: transparent;
}

.diff-unified .diff-gutter-delete,
.diff-split .diff-gutter-delete {
  background-color: var(--color-diff-delete-gutter-bg);
  color: var(--color-diff-delete-gutter-text);
}

/* Context lines */
.diff-unified .diff-code-normal,
.diff-split .diff-code-normal {
  background-color: transparent;
}

.diff-unified .diff-gutter-normal,
.diff-split .diff-gutter-normal {
  background-color: var(--color-gutter-bg);
}

/* Hunk headers */
.diff-unified .diff-hunk-header,
.diff-split .diff-hunk-header {
  background-color: var(--color-hunk-bg);
  border-top: 1px solid var(--color-hunk-border);
  border-bottom: 1px solid var(--color-hunk-border);
}

.diff-unified .diff-hunk-header-gutter,
.diff-split .diff-hunk-header-gutter {
  background-color: var(--color-hunk-gutter-bg);
  color: var(--color-hunk-gutter-text);
}

.diff-unified .diff-hunk-header-content,
.diff-split .diff-hunk-header-content {
  color: var(--color-hunk-content-text);
  padding: 4px 12px;
  font-style: italic;
}

/* Word-level diff highlighting */
.diff-unified .diff-code-edit .diff-code-text .diff-code-edit-text,
.diff-split .diff-code-edit .diff-code-text .diff-code-edit-text {
  background-color: var(--color-diff-edit-insert);
  border-radius: 2px;
}

.diff-unified .diff-code-delete .diff-code-text .diff-code-edit-text,
.diff-split .diff-code-delete .diff-code-text .diff-code-edit-text {
  background-color: var(--color-diff-edit-delete);
  border-radius: 2px;
}

/* Table styling */
.diff-unified table,
.diff-split table {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed;
}

.diff-unified td,
.diff-split td {
  vertical-align: top;
}

/* Split view: add a visible divider between old/new sides */
.diff-split .diff-split-side-new .diff-gutter {
  border-left: 1px solid var(--color-split-divider);
}

/* Syntax highlighting tokens (refractor) */
.diff-unified .token.comment,
.diff-unified .token.prolog,
.diff-unified .token.doctype,
.diff-unified .token.cdata,
.diff-split .token.comment,
.diff-split .token.prolog,
.diff-split .token.doctype,
.diff-split .token.cdata {
  color: var(--color-token-comment);
}

.diff-unified .token.punctuation,
.diff-split .token.punctuation {
  color: var(--color-token-punctuation);
}

.diff-unified .token.property,
.diff-unified .token.tag,
.diff-unified .token.boolean,
.diff-unified .token.number,
.diff-unified .token.constant,
.diff-unified .token.symbol,
.diff-split .token.property,
.diff-split .token.tag,
.diff-split .token.boolean,
.diff-split .token.number,
.diff-split .token.constant,
.diff-split .token.symbol {
  color: var(--color-token-property);
}

.diff-unified .token.selector,
.diff-unified .token.attr-name,
.diff-unified .token.string,
.diff-unified .token.char,
.diff-unified .token.builtin,
.diff-split .token.selector,
.diff-split .token.attr-name,
.diff-split .token.string,
.diff-split .token.char,
.diff-split .token.builtin {
  color: var(--color-token-string);
}

.diff-unified .token.operator,
.diff-unified .token.entity,
.diff-unified .token.url,
.diff-split .token.operator,
.diff-split .token.entity,
.diff-split .token.url {
  color: var(--color-token-operator);
}

.diff-unified .token.atrule,
.diff-unified .token.attr-value,
.diff-unified .token.keyword,
.diff-split .token.atrule,
.diff-split .token.attr-value,
.diff-split .token.keyword {
  color: var(--color-token-keyword);
}

.diff-unified .token.function,
.diff-unified .token.class-name,
.diff-split .token.function,
.diff-split .token.class-name {
  color: var(--color-token-function);
}

.diff-unified .token.regex,
.diff-unified .token.important,
.diff-unified .token.variable,
.diff-split .token.regex,
.diff-split .token.important,
.diff-split .token.variable {
  color: var(--color-token-variable);
}

.diff-unified .token.string,
.diff-split .token.string {
  color: var(--color-token-string);
}

/* ─── Hunk focus ─── */

.diff-hunk-focused {
  outline: 2px solid var(--color-accent);
  outline-offset: -2px;
}

/* ─── Inline commenting ─── */

/* Make gutters clickable */
.diff-unified .diff-gutter,
.diff-split .diff-gutter {
  cursor: pointer;
  position: relative;
}

/* Green "+" button on gutter hover */
.diff-gutter-add-comment {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
  border-radius: 3px;
  background-color: var(--color-comment-btn-bg);
  color: #ffffff;
  font-size: 12px;
  font-weight: bold;
  line-height: 1;
  position: absolute;
  left: 2px;
  top: 50%;
  transform: translateY(-50%);
}

/* Blue dot for lines with existing comments */
.diff-comment-indicator {
  display: inline-block;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background-color: var(--color-comment-indicator);
  position: absolute;
  left: 4px;
  top: 50%;
  transform: translateY(-50%);
}

/* Amber dot for lines with agent annotations */
.diff-annotation-indicator {
  display: inline-block;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background-color: var(--color-annotation-indicator);
  position: absolute;
  left: 4px;
  top: 50%;
  transform: translateY(-50%);
}

/* Widget row styling */
.diff-widget {
  background-color: var(--color-widget-bg);
}

.diff-widget-content {
  padding: 0;
}

/* Scrollbar styling */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--color-scrollbar-track);
}

::-webkit-scrollbar-thumb {
  background: var(--color-scrollbar-thumb);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--color-scrollbar-thumb-hover);
}
