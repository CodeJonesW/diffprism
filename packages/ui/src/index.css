@import "react-diff-view/style/index.css";

@tailwind base;
@tailwind components;
@tailwind utilities;

/* ─── Theme variables ─── */

:root {
  /* Layout */
  --color-background: #ffffff;
  --color-surface: #f6f8fa;
  --color-border: #d0d7de;
  --color-text-primary: #1f2328;
  --color-text-secondary: #656d76;
  --color-accent: #0969da;

  /* Diff */
  --color-diff-bg: #ffffff;
  --color-diff-text: #1f2328;
  --color-gutter-bg: #f6f8fa;
  --color-gutter-text: #656d76;
  --color-gutter-border: #d0d7de;

  /* Diff additions */
  --color-diff-insert-bg: rgba(46, 160, 67, 0.15);
  --color-diff-insert-gutter-bg: rgba(46, 160, 67, 0.2);
  --color-diff-insert-gutter-text: #1a7f37;

  /* Diff deletions */
  --color-diff-delete-bg: rgba(248, 81, 73, 0.15);
  --color-diff-delete-gutter-bg: rgba(248, 81, 73, 0.2);
  --color-diff-delete-gutter-text: #cf222e;

  /* Diff hunks */
  --color-hunk-bg: rgba(9, 105, 218, 0.1);
  --color-hunk-border: #d0d7de;
  --color-hunk-gutter-bg: rgba(9, 105, 218, 0.15);
  --color-hunk-gutter-text: #0969da;
  --color-hunk-content-text: #656d76;

  /* Word-level diff */
  --color-diff-edit-insert: rgba(46, 160, 67, 0.4);
  --color-diff-edit-delete: rgba(248, 81, 73, 0.4);

  /* Split view divider */
  --color-split-divider: #d0d7de;

  /* Widget */
  --color-widget-bg: #f6f8fa;

  /* Inline comment button */
  --color-comment-btn-bg: #238636;
  --color-comment-indicator: #0969da;

  /* Scrollbar */
  --color-scrollbar-track: #ffffff;
  --color-scrollbar-thumb: #d0d7de;
  --color-scrollbar-thumb-hover: #afb8c1;

  /* Syntax tokens */
  --color-token-comment: #6e7781;
  --color-token-punctuation: #1f2328;
  --color-token-property: #0550ae;
  --color-token-string: #0a3069;
  --color-token-operator: #cf222e;
  --color-token-keyword: #cf222e;
  --color-token-function: #8250df;
  --color-token-variable: #953800;

  /* Semantic colors for Tailwind */
  --color-added: rgba(46, 160, 67, 0.44);
  --color-deleted: rgba(248, 81, 73, 0.44);
}

.dark {
  /* Layout */
  --color-background: #0d1117;
  --color-surface: #161b22;
  --color-border: #30363d;
  --color-text-primary: #e6edf3;
  --color-text-secondary: #8b949e;
  --color-accent: #58a6ff;

  /* Diff */
  --color-diff-bg: #0d1117;
  --color-diff-text: #e6edf3;
  --color-gutter-bg: #161b22;
  --color-gutter-text: #8b949e;
  --color-gutter-border: #30363d;

  /* Diff additions */
  --color-diff-insert-bg: rgba(46, 160, 67, 0.15);
  --color-diff-insert-gutter-bg: rgba(46, 160, 67, 0.2);
  --color-diff-insert-gutter-text: #7ee787;

  /* Diff deletions */
  --color-diff-delete-bg: rgba(248, 81, 73, 0.15);
  --color-diff-delete-gutter-bg: rgba(248, 81, 73, 0.2);
  --color-diff-delete-gutter-text: #f85149;

  /* Diff hunks */
  --color-hunk-bg: rgba(88, 166, 255, 0.1);
  --color-hunk-border: #30363d;
  --color-hunk-gutter-bg: rgba(88, 166, 255, 0.15);
  --color-hunk-gutter-text: #58a6ff;
  --color-hunk-content-text: #8b949e;

  /* Word-level diff */
  --color-diff-edit-insert: rgba(46, 160, 67, 0.4);
  --color-diff-edit-delete: rgba(248, 81, 73, 0.4);

  /* Split view divider */
  --color-split-divider: #30363d;

  /* Widget */
  --color-widget-bg: #161b22;

  /* Inline comment button */
  --color-comment-btn-bg: #238636;
  --color-comment-indicator: #58a6ff;

  /* Scrollbar */
  --color-scrollbar-track: #0d1117;
  --color-scrollbar-thumb: #30363d;
  --color-scrollbar-thumb-hover: #484f58;

  /* Syntax tokens */
  --color-token-comment: #8b949e;
  --color-token-punctuation: #e6edf3;
  --color-token-property: #79c0ff;
  --color-token-string: #a5d6ff;
  --color-token-operator: #ff7b72;
  --color-token-keyword: #ff7b72;
  --color-token-function: #d2a8ff;
  --color-token-variable: #ffa657;

  /* Semantic colors for Tailwind */
  --color-added: rgba(46, 160, 67, 0.44);
  --color-deleted: rgba(248, 81, 73, 0.44);
}

/* ─── Dark theme overrides for react-diff-view ─── */

.diff-unified,
.diff-split {
  background-color: var(--color-diff-bg);
  color: var(--color-diff-text);
  font-family: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas,
    "Liberation Mono", monospace;
  font-size: 13px;
  line-height: 20px;
}

.diff-unified .diff-gutter,
.diff-split .diff-gutter {
  background-color: var(--color-gutter-bg);
  color: var(--color-gutter-text);
  border-right: 1px solid var(--color-gutter-border);
  padding: 0 8px;
  min-width: 50px;
  text-align: right;
  user-select: none;
  cursor: default;
}

.diff-unified .diff-gutter-col,
.diff-split .diff-gutter-col {
  width: 60px;
  min-width: 60px;
}

.diff-unified .diff-code,
.diff-split .diff-code {
  padding: 0 12px;
  white-space: pre;
}

/* Addition lines */
.diff-unified .diff-code-insert,
.diff-split .diff-code-insert {
  background-color: var(--color-diff-insert-bg);
}

.diff-unified .diff-code-insert .diff-code-text,
.diff-split .diff-code-insert .diff-code-text {
  background-color: transparent;
}

.diff-unified .diff-gutter-insert,
.diff-split .diff-gutter-insert {
  background-color: var(--color-diff-insert-gutter-bg);
  color: var(--color-diff-insert-gutter-text);
}

/* Deletion lines */
.diff-unified .diff-code-delete,
.diff-split .diff-code-delete {
  background-color: var(--color-diff-delete-bg);
}

.diff-unified .diff-code-delete .diff-code-text,
.diff-split .diff-code-delete .diff-code-text {
  background-color: transparent;
}

.diff-unified .diff-gutter-delete,
.diff-split .diff-gutter-delete {
  background-color: var(--color-diff-delete-gutter-bg);
  color: var(--color-diff-delete-gutter-text);
}

/* Context lines */
.diff-unified .diff-code-normal,
.diff-split .diff-code-normal {
  background-color: transparent;
}

.diff-unified .diff-gutter-normal,
.diff-split .diff-gutter-normal {
  background-color: var(--color-gutter-bg);
}

/* Hunk headers */
.diff-unified .diff-hunk-header,
.diff-split .diff-hunk-header {
  background-color: var(--color-hunk-bg);
  border-top: 1px solid var(--color-hunk-border);
  border-bottom: 1px solid var(--color-hunk-border);
}

.diff-unified .diff-hunk-header-gutter,
.diff-split .diff-hunk-header-gutter {
  background-color: var(--color-hunk-gutter-bg);
  color: var(--color-hunk-gutter-text);
}

.diff-unified .diff-hunk-header-content,
.diff-split .diff-hunk-header-content {
  color: var(--color-hunk-content-text);
  padding: 4px 12px;
  font-style: italic;
}

/* Word-level diff highlighting */
.diff-unified .diff-code-edit .diff-code-text .diff-code-edit-text,
.diff-split .diff-code-edit .diff-code-text .diff-code-edit-text {
  background-color: var(--color-diff-edit-insert);
  border-radius: 2px;
}

.diff-unified .diff-code-delete .diff-code-text .diff-code-edit-text,
.diff-split .diff-code-delete .diff-code-text .diff-code-edit-text {
  background-color: var(--color-diff-edit-delete);
  border-radius: 2px;
}

/* Table styling */
.diff-unified table,
.diff-split table {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed;
}

.diff-unified td,
.diff-split td {
  vertical-align: top;
}

/* Split view: add a visible divider between old/new sides */
.diff-split .diff-split-side-new .diff-gutter {
  border-left: 1px solid var(--color-split-divider);
}

/* Syntax highlighting tokens (refractor) */
.diff-unified .token.comment,
.diff-unified .token.prolog,
.diff-unified .token.doctype,
.diff-unified .token.cdata,
.diff-split .token.comment,
.diff-split .token.prolog,
.diff-split .token.doctype,
.diff-split .token.cdata {
  color: var(--color-token-comment);
}

.diff-unified .token.punctuation,
.diff-split .token.punctuation {
  color: var(--color-token-punctuation);
}

.diff-unified .token.property,
.diff-unified .token.tag,
.diff-unified .token.boolean,
.diff-unified .token.number,
.diff-unified .token.constant,
.diff-unified .token.symbol,
.diff-split .token.property,
.diff-split .token.tag,
.diff-split .token.boolean,
.diff-split .token.number,
.diff-split .token.constant,
.diff-split .token.symbol {
  color: var(--color-token-property);
}

.diff-unified .token.selector,
.diff-unified .token.attr-name,
.diff-unified .token.string,
.diff-unified .token.char,
.diff-unified .token.builtin,
.diff-split .token.selector,
.diff-split .token.attr-name,
.diff-split .token.string,
.diff-split .token.char,
.diff-split .token.builtin {
  color: var(--color-token-string);
}

.diff-unified .token.operator,
.diff-unified .token.entity,
.diff-unified .token.url,
.diff-split .token.operator,
.diff-split .token.entity,
.diff-split .token.url {
  color: var(--color-token-operator);
}

.diff-unified .token.atrule,
.diff-unified .token.attr-value,
.diff-unified .token.keyword,
.diff-split .token.atrule,
.diff-split .token.attr-value,
.diff-split .token.keyword {
  color: var(--color-token-keyword);
}

.diff-unified .token.function,
.diff-unified .token.class-name,
.diff-split .token.function,
.diff-split .token.class-name {
  color: var(--color-token-function);
}

.diff-unified .token.regex,
.diff-unified .token.important,
.diff-unified .token.variable,
.diff-split .token.regex,
.diff-split .token.important,
.diff-split .token.variable {
  color: var(--color-token-variable);
}

.diff-unified .token.string,
.diff-split .token.string {
  color: var(--color-token-string);
}

/* ─── Inline commenting ─── */

/* Make gutters clickable */
.diff-unified .diff-gutter,
.diff-split .diff-gutter {
  cursor: pointer;
  position: relative;
}

/* Green "+" button on gutter hover */
.diff-gutter-add-comment {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
  border-radius: 3px;
  background-color: var(--color-comment-btn-bg);
  color: #ffffff;
  font-size: 12px;
  font-weight: bold;
  line-height: 1;
  position: absolute;
  left: 2px;
  top: 50%;
  transform: translateY(-50%);
}

/* Blue dot for lines with existing comments */
.diff-comment-indicator {
  display: inline-block;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background-color: var(--color-comment-indicator);
  position: absolute;
  left: 4px;
  top: 50%;
  transform: translateY(-50%);
}

/* Widget row styling */
.diff-widget {
  background-color: var(--color-widget-bg);
}

.diff-widget-content {
  padding: 0;
}

/* Scrollbar styling */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--color-scrollbar-track);
}

::-webkit-scrollbar-thumb {
  background: var(--color-scrollbar-thumb);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--color-scrollbar-thumb-hover);
}
